[platformio]
default_envs = esp32-s3-devkitc-1

[env:esp32-s3-devkitc-1]
platform = espressif32@6.6.0
board = esp32-s3-devkitc-1
framework = arduino
monitor_speed = 115200
upload_speed = 921600

; Board configuration
board_build.partitions = default_16MB.csv
board_build.arduino.memory_type = qio_opi
board_build.arduino.memory_psram = qio_opi
board_build.flash_mode = qio
board_build.f_cpu = 240000000L
board_build.f_flash = 80000000L
board_build.flash_size = 16MB

; Build configuration
build_type = debug
build_unflags = -Os
build_flags = 
    -O2
    -g
    ; LVGL configuration
    -D LV_LVGL_H_INCLUDE_SIMPLE
    -D LV_CONF_INCLUDE_SIMPLE
    -D LV_CONF_PATH=lv_conf.h
    ; Display configuration
    -D CONFIG_LV_DISPLAY_ORIENTATION_LANDSCAPE
    -D CONFIG_LV_DISPLAY_WIDTH=800
    -D CONFIG_LV_DISPLAY_HEIGHT=480
    ; PSRAM configuration
    -DBOARD_HAS_PSRAM
    -mfix-esp32-psram-cache-issue
    ; Other optimizations
    -DCORE_DEBUG_LEVEL=5
    ; TFT_eSPI configuration
    -D USER_SETUP_LOADED=1
    -D TFT_DRIVER=ST7796
    -D TFT_WIDTH=480
    -D TFT_HEIGHT=320
    -D CGRAM_OFFSET
    -D TFT_MISO=39
    -D TFT_MOSI=41
    -D TFT_SCLK=40
    -D TFT_CS=42
    -D TFT_DC=45
    -D TFT_RST=-1
    -D TFT_BL=46
    -D LOAD_GLCD=1
    -D LOAD_FONT2=1
    -D LOAD_FONT4=1
    -D LOAD_FONT6=1
    -D LOAD_FONT7=1
    -D LOAD_FONT8=1
    -D LOAD_GFXFF=1
    -D SMOOTH_FONT=1

; Debug configuration
debug_tool = esp-builtin

; Libraries
lib_deps = 
    lvgl/lvgl@^8.4.0
    bblanchon/ArduinoJson@^6.21.3
    earlephilhower/ESP8266Audio@^1.9.7
    adafruit/Adafruit SGP30 Sensor@^2.0.2
    adafruit/Adafruit SHT31 Library@^2.2.2
    adafruit/Adafruit BusIO@^1.14.3
    me-no-dev/AsyncTCP@^1.1.1
    https://github.com/me-no-dev/ESPAsyncWebServer/archive/refs/heads/master.zip
    bodmer/TFT_eSPI @ ^2.5.43
    https://github.com/ayushsharma82/AsyncElegantOTA/archive/refs/heads/master.zip
    ; SD_MMC is included in the ESP32 Arduino Core

; TFT_eSPI configuration is now in the main build_flags section

; Enable OTA updates
upload_protocol = espota
upload_port = 192.168.1.100  ; Update this with your device's IP
upload_flags =
    --auth=ota_password      ; Set a secure OTA password
    --port=3232
    --auth=ota_password

; Monitor configuration
monitor_filters = colorize, time
monitor_dtr = 0
monitor_rts = 0
